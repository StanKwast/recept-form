<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Submit a Recipe</title>
</head>
<body>
  <h1>Recipe Submission Form</h1>
  <form id="recipeForm">
    <label>Title: <input type="text" name="title" required></label><br>
    <label>Category: <input type="text" name="category" required></label><br>
    <label>Ingredients:<br>
      <textarea name="ingredients" rows="5" required></textarea>
    </label><br>
    <label>Instructions:<br>
      <textarea name="instructions" rows="5" required></textarea>
    </label><br>
    <button type="submit">Submit Recipe</button>
  </form>

  <p id="status"></p>

  <script>
    document.getElementById("recipeForm").addEventListener("submit", async function (e) {
      e.preventDefault();

      const formData = new FormData(e.target);
      const recipe = {
        title: formData.get("title").trim(),
        category: formData.get("category").trim(),
        ingredients: formData.get("ingredients").trim().split("\n"),
        instructions: formData.get("instructions").trim().split("\n"),
        timestamp: new Date().toISOString()
      };

      const filename = recipe.title.toLowerCase().replace(/\s+/g, "_") + "_" + Date.now() + ".json";

      const response = await fetch("https://recept-form-czminkuvq-stankwasts-projects.vercel.app/api/submit", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ filename, recipe })
      });

      const status = document.getElementById("status");
      if (response.ok) {
        status.textContent = "Recipe submitted successfully!";
        e.target.reset();
      } else {
        const error = await response.json();
        status.textContent = "Error: " + (error?.message || "Unknown error.");
      }
    });
  </script>
</body>
</html>
